// Generated by CoffeeScript 1.9.1
(function() {
  var recalc, spop, spush;

  spush = function() {
    var ptype, topel;
    topel = $('a.topic').first();
    if (topel.attr('id') === 'empty-stack') {
      topel.addClass('hideme');
    } else {
      topel.removeClass('active');
    }
    ptype = $('a#ptype').clone();
    ptype.removeAttr('id');
    ptype.removeClass('hideme');
    ptype.addClass('active');
    ptype.text($('input').val());
    ptype.insertBefore(topel);
    $('input').val('');
    return recalc();
  };

  spop = function() {
    var doomed, newtop;
    doomed = $('a.topic.active').first();
    newtop = $('a.topic').not('.active').first();
    doomed.removeClass('active');
    if (newtop.attr('id') === 'empty-stack') {
      newtop.removeClass('hideme');
    } else {
      newtop.addClass('active');
    }
    doomed.slideUp(400, function() {
      return this.remove();
    });
    return recalc();
  };

  recalc = function() {
    $('a.topic').unbind();
    return $('a.topic').not('#ptype').not('#empty-stack').click(spop);
  };

  $(document).ready(function() {
    $('#push').click(spush);
    $('input').focus();
    $('input').select();
    $('input').keyup(function(event) {
      if (event.which === 13) {
        spush();
      }
      if (event.which === 0x2e && $('input').val() === '') {
        return spop();
      }
    });
    return recalc();
  });

}).call(this);
